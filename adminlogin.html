<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="initial-scale=1.0" />
    <link rel="webside icon" type="png" href="/img/icon/icon.jpg" />
    <link rel="stylesheet" type="text/css" href="css/login.css" />
    <link rel="stylesheet" href="css/head-footer.css" />
    <!--link này dùng chung cho header , footer-->
    <link rel="stylesheet" href="css/homepage.css" />
    <title>Flea Shop</title>
  </head>
  <body>
    <div class="header">
      <a class="title1" href="homepage.html">Flea Shop</a>
    </div>
    <div>
      <div class="container">
        <div class="login">
          <p>Quản trị viên</p>
          <form id="loginForm">
            <input type="text" name="username" placeholder="Username" />
            <input type="password" name="password" placeholder="Password" />
            <button type="submit">Login</button>
            <div id="errorMessage" class="errorMessage"></div>
          </form>
        </div>

<script>
  // Lắng nghe sự kiện submit form
  document.getElementById("loginForm").addEventListener("submit", function (event) {
    event.preventDefault(); // Ngăn chặn việc gửi yêu cầu mặc định của form

    // Lấy giá trị email và password từ form
    var email = document.getElementsByName("username")[0].value;
    var password = document.getElementsByName("password")[0].value;

    // Xây dựng chuỗi query parameters
    var queryParams = new URLSearchParams();
    queryParams.set("Email", email);
    queryParams.set("Password", password);

    // Gửi yêu cầu POST đến API với query parameters
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "http://localhost:8080/Account/login?" + queryParams.toString(), true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xhr.onreadystatechange = function () {
      if (xhr.readyState === XMLHttpRequest.DONE) {
        if (xhr.status === 200) {
  // Xử lý phản hồi thành công từ API
  var response = xhr.responseText;
  // Hiển thị thông báo thành công
  document.getElementById("errorMessage").innerText = response;
  window.location.href = "adminpage.html";
}else {
          // Xử lý phản hồi lỗi từ API
          var errorResponse = JSON.parse(xhr.responseText);
          // Hiển thị thông báo lỗi
          document.getElementById("errorMessage").innerText = errorResponse;
        }
      }
    };
    xhr.send();
  });
</script>

    </div>
  </body>
  <footer style="position: absolute">
    <div class="container-fluid footer">
      Address: Lot E2a-7, Road D1, D. D1, Long Thanh My, Thu Duc City, Ho Chi
      Minh City<br />
      Contact us: fleashop@gmail.com
    </div>
  </footer>
</html>
