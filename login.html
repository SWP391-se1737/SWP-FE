<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="initial-scale=1.0" />
    <link rel="webside icon" type="png" href="/img/icon/icon.jpg" />
    <link rel="stylesheet" type="text/css" href="css/login.css" />
    <link rel="stylesheet" href="css/head-footer.css" />
    <!--link này dùng chung cho header , footer-->
    <link rel="stylesheet" href="css/homepage.css" />
    <title>Flea Shop</title>
  </head>
  <body>
    <div class="header">
      <a class="title1" href="homepage.html">Flea Shop</a>
    </div>
    <div class="container">
      <div class="login">
        <h1>LOGIN</h1>
        <form id="loginForm">
          <input type="text" name="username" placeholder="Username" />
          <input type="password" name="password" placeholder="Password" />
          <button type="submit">Login</button>
          <button onclick="loginWithGoogle()">Login with Google</button>
          <div id="errorMessage" class="errorMessage"></div>
        </form>
      </div>
    </div>
    
    <script>
      const loginForm = document.getElementById("loginForm");
      const errorMessage = document.getElementById("errorMessage");

      loginForm.addEventListener("submit", function (e) {
        e.preventDefault();

        const username = loginForm.elements.username.value;
        const password = loginForm.elements.password.value;

        // Gửi yêu cầu đăng nhập thông qua API
        fetch("http://localhost:8080/Account/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded",
          },
          body: `username=${encodeURIComponent(
            username
          )}&password=${encodeURIComponent(password)}`,
        })
          .then(function (response) {
            if (response.ok) {
              // Đăng nhập thành công
              window.location.href = "adminpage.html";
            } else if (response.status === 401) {
              // Đăng nhập thất bại
              errorMessage.textContent = "Invailid Username or Password";
            } else {
              // Xử lý các trường hợp lỗi khác
              errorMessage.textContent = "Đã xảy ra lỗi";
            }
          })
          .catch(function (error) {
            console.error(error);
          });
      });

    </script>
  </body>
  <div class="container-fluid footer">
    Address: Lot E2a-7, Road D1, D. D1, Long Thanh My, Thu Duc City, Ho Chi Minh
    City<br />
    Contact us: fleashop@gmail.com
  </div>
</html>
