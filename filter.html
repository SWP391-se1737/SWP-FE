<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="initial-scale=1.0">
      <link rel="webside icon" type="png" href="/img/icon/icon.jpg">
      <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      <!-- font google -->
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Caveat&display=swap" rel="stylesheet">
    
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@400;700&display=swap" rel="stylesheet">
      <!-- fontawesome -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
      <!-- Bootstrap -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
      <!-- Css -->
      <!-- <link rel="stylesheet" href="css/style.css"> -->
      <!--link này dùng cho trang index.html-->
      <!--script src="js/Product.js"></!--script-->
      <link rel="stylesheet" href="css/head-footer.css">
      <!--link này dùng chung cho header , footer-->
      <link rel="stylesheet" href="css/homepage.css">
      
      <link rel="stylesheet" type="text/css" href="css/productDetail.css">
      <title>Flea Shop</title>
    </head>
<body>
    <!-- navbar -->
  <nav class="navbar">
    <div class="container-fluid">
      <a class="navbar-brand" href="homepage.html">Flea Shop</a>
      <form class="d-flex" role="search">
        <input id="searchbar" onkeyup="search_animal()"  name="search" class="form-control me-2" type="search" placeholder="Search product" aria-label="Search">
                  <a href="searchproduct.html" class="btn"><i class="fa-solid fa-magnifying-glass"></i></a>
        <a href="shopping-cart.html" class="ping"><i class="fa-solid fa-cart-shopping"></i><span
            class="qtycart">0</span></a>
      </form>
      <a href="postProduct.html" class="button">
       <span class="button-text">
          Post product
        </span>
      </a>
    </div>
  </nav>
  <nav class="navbar navbar-expand-lg bg-secondary navtwo">
    <div class="container-fluid tog">
      <div class="collapse navbar-collapse menu" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" href="homepage.html" aria-current="page">Home</a>
          </li>
          <li class="nav-item franchising">
            <a class="nav-link " href="news.html">News</a>
          </li>
          <li class="nav-item location">
            <a class="nav-link " href="location.html">Locations</a>
          </li>
          <li class="nav-item aboutus">
            <a class="nav-link " href="login.html">Sign in</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
 

  <script>
    
const getData = async () => {
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('category_id');
    const response = await axios.get(`http://localhost:8080/product/filterProductByCategory?category_id=${id}`);
    const products = response.data;
    renderProducts(products)
    }
    getData();
    const renderProducts = (products) => {
    const list = document.getElementById('productDetail');
    if (list) {
        list.innerHTML = '';
    products.forEach(result => {
      // Tạo phần tử và thiết lập nội dung
      // ...
      // Thêm phần tử vào danh sách
      // ...
      const productId = result.id;
        const divItem = document.createElement('div');
        divItem.classList.add(`detail`);
        divItem.dataset.key = productId;


        const img = document.createElement('img');
        img.src = result.image;

        const h2 = document.createElement('h2');
        h2.innerText = result.name;

        const h3 = document.createElement('p');
        h3.innerText = result.price;

        const p = document.createElement('p');
        p.innerText = result.status;

        divItem.appendChild(img);
        divItem.appendChild(h2);
        divItem.appendChild(h3);
        divItem.appendChild(p);

        list.appendChild(divItem);

        divItem.addEventListener('click', () => {
          getProductDetail(divItem.dataset.key)
        })
    });
        
    } else {
        console.error("Phần tử searchProduct không tồn tại.");
    }
};
const getProductDetail = async (productId) => {
  // const response = await axios.get(`http://localhost:8080/product/getProductById/${productId}`);
  const testPageUrl = `productDetail.html?id=${encodeURIComponent(productId)}`;
  window.location.href = testPageUrl;
}
  </script>
    <div class="content">
          
        <div id="productDetail" class="listProduct">
            
        </div>
          
    </div>
    <script src="js/Product.js"></script>
    
</body>
<div class="container-fluid footer">
  Address: Lot E2a-7, Road D1, D. D1, Long Thanh My, Thu Duc City, Ho Chi Minh City<br/>
  Contact us: fleashop@gmail.com
</div>
</html>